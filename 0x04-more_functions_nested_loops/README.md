more fnctions and nested loop
